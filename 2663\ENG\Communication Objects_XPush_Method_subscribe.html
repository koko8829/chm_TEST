<!DOCTYPE	html PUBLIC	'-//W3C//DTD XHTML 1.0 Transitional//EN' 'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'>  
<html	xmlns='http://www.w3.org/1999/xhtml'> 
<head> 
<meta	http-equiv='Content-Type' content='text/html; charset=utf-8'/> 
<title>XPush_Method_subscribe</title> 
<style type='text/css'> </style>
<link	href='../../help_Eng.css' rel='stylesheet' type='text/css' /> 
</head> 
 
<body> 
<table width='100%' border='0' cellpadding='0' cellspacing='0' bgcolor='#FFFFFF'> 
	<tr> 
		<td	height='44'	colspan='2'	background='../../top_bg1.gif'> 
			<table width='100%' border='0' cellspacing='0' cellpadding='0'  bgcolor='#ffffff'> 
				<tr> 
					<td><img src='../../logo1.gif' width='134' height='44' /></td> 
					<td width='100%' bgcolor='#FFFFFF'> 
					<td style='padding-right:6px;'><img src='../../logo4.gif' width='110' height='28' /></td> 
				</tr> 
			</table> 
		</td> 
	</tr> 
	<tr> 
		<td	height='28'	colspan='2' bgcolor='#eeeeee'> 
			<table width='600' border='0' cellspacing='0' cellpadding='0'>  
				<tr> 
					<td	width='107'><img src='../../logo2.gif' width='107' height='28' /></td>  
					<td	class='top_navi'>Communication Objects > XPush > Method > subscribe</td> 
				</tr> 
			</table> 
		</td> 
	</tr> 
	<tr> 
		<td	height='20'	colspan='2'	valign='top'> 
			<table width='82'	border='0' cellspacing='0' cellpadding='0'> 
				<tr> 
					<td></td> 
				 </tr> 
			</table> 
		</td> 
	</tr> 
 
	<tr	class='list'> 
		<td	colspan='2'	valign='top'> 
 
			<table width='98%' border='0' align='center' cellpadding='0' cellspacing='0' style='table-layout: fixed; word-wrap:break-word;'>  
				<tr> 
					<td	colspan='2' width='24'></td> 
					<td></td> 
				</tr> 
				<tr><td	colspan='3' class='title'>subscribe</td></tr> 
				<tr><td colspan='3' height='5'></td></tr> 
				<tr><td colspan='3' height='1' bgcolor='#c5c5c6'></td></tr> 
				<tr> 
					<td	colspan='3' height='10'></td> 
				</tr> 
				<tr> 
					<td	width='10'></td> 
					<td	width='14'><img	src='../../subtitle_icon.gif' width='14' height='8' /></td> 
					<td	class='sub_title'>Supported Environments</td> 
				</tr> 
				<tr> 
					<td	colspan='3' height='10'></td> 
				</tr> 
				<tr> 
					<td	colspan='2' width='24'></td> 
					<td	>				<table border ='0' width='100%'> 
					<tr> 
						<td colspan='20'>[Desktop]</td>
						<td align='right' valign='middle'><img src='../../support_legend2_2.gif' /></td> 
					</tr>
					<tr>
						<td colspan='21'>Nexacro Runtime Environment (NRE)</td>
					</tr>
					<tr>
						<td width='16'><img src='../../support01.gif' width='16' height='17'/></td>
						<td colspan='7' style='white-space:nowrap;'>Windows</td>
						<td width='16'><img src='../../support01.gif' width='16' height='17'/></td>
						<td colspan='12' style='white-space:nowrap;'>macOS</td>
					</tr>
					<tr>
						<td colspan='21'>Web Runtime Environment (WRE)</td>
					</tr>
					<tr> 
						<td width='16'><img src='../../support01.gif' width='16' height='17'/></td>
						<td width='30'>Edge</td>
						<td width='16'><img src='../../support01.gif' width='16' height='17'/></td>
						<td width='46'>Chrome</td>
						<td width='16'><img src='../../support01.gif' width='16' height='17'/></td>
						<td width='40'>Safari</td>
						<td width='16'><img src='../../support01.gif' width='16' height='17'/></td>
						<td width='45'>Firefox</td>
						<td width='16'><img src='../../support01.gif' width='16' height='17'/></td>
						<td colspan='8' width='40'>Opera</td>
					</tr> 
					<tr>
						<td colspan='21' height='10'></td>
					</tr> 
					<tr>
						<td colspan='21' height='18'>[Mobile]</td>
					</tr> 
					<tr>
						<td colspan='21'>Nexacro Runtime Environment (NRE)</td>
					</tr>
					<tr> 
						<td width='16'><img src='../../support01.gif' width='16' height='17'/></td>
						<td colspan='7' style='white-space:nowrap;'>Android</td>
						<td width='16'><img src='../../support01.gif' width='16' height='17'/></td>
						<td colspan='12' style='white-space:nowrap;'>iOS/iPadOS</td>
					</tr> 
					<tr>
						<td colspan='21'>Web Runtime Environment (WRE)</td>
					</tr>
					<tr> 
						<td width='16'><img src='../../support01.gif' width='16' height='17'/></td>
						<td colspan='7' style='white-space:nowrap;'>Android Default Web Browser</td>
						<td width='16'><img src='../../support01.gif' width='16' height='17'/></td>
						<td colspan='12' style='white-space:nowrap;'>iOS/iPadOS Default Web Browser</td>
					</tr> 
				</table> 
</td> 
				</tr> 
				<tr> 
					<td	colspan='3' height='10'></td> 
				</tr> 
				<tr> 
					<td	colspan='3' height='10'></td> 
				</tr> 
				<tr> 
					<td	width='10'></td> 
					<td	width='14'><img	src='../../subtitle_icon.gif' width='14' height='8' /></td> 
					<td	class='sub_title'>Description</td> 
				</tr> 
				<tr> 
					<td	colspan='3' height='10'></td> 
				</tr> 
				<tr> 
					<td	colspan='2'></td> 
					<td	class='list'><pre class='list'>The method to register a topic on the X-PUSH server connected to receive messages.</pre></td> 
				</tr> 
				<tr> 
					<td	colspan='3' height='10'></td> 
				</tr> 
				<tr> 
					<td	width='10'></td> 
					<td	width='14'><img	src='../../subtitle_icon.gif' width='14' height='8' /></td> 
					<td	class='sub_title'>Syntax</td> 
				</tr> 
				<tr> 
					<td	colspan='3' height='10'></td> 
				</tr> 
				<tr> 
					<td	colspan='2'></td> 
					<td	class='list'><pre class='list'>XPush.subscribe(strMsgType, strMsgKey, objForm, objDataset, strType, strCallBack[, nRow[, strCheck[, bUseActiveFormCallBack]]])</pre></td> 
				</tr> 
				<tr> 
					<td	colspan='3' height='10'></td> 
				</tr> 
				<tr> 
					<td	width='10'></td> 
					<td	width='14'><img	src='../../subtitle_icon.gif'	width='14' height='8'	/></td> 
					<td	class='sub_title'>Parameters</td> 
				</tr> 
				<tr> 
					<td	colspan='3' height='10'></td> 
				</tr> 
				<tr> 
					<td	colspan='2'></td> 
					<td	class='list'> 
						<table width='100%' border='1' cellpadding='7' cellspacing='0' bordercolorlight='#C6C6C6' bordercolordark='#C6C6C6' style='table-layout:fixed; word-wrap:break-word; border-collapse:collapse;'> 
							<colgroup> 
								<col width='20%'></col> 
								<col width='15%'></col> 
								<col width='50%'></col> 
								<col width='15%'></col> 
							</colgroup> 
							<tr class='table_title' bgcolor='#F6F6F6' bordercolor='#c6c6c6'> 
								<td align='center'>Parameters</td> 
								<td align='center'>Type</td> 
								<td colspan='2' align='center'>Description</td> 
							</tr> 
							<tr class='list' bgcolor='#FFFFFF' bordercolor='#c6c6c6'> 
								<td>strMsgType</td> 
								<td>String</td> 
								<td colspan='2'><pre class='list'>This is a string representing the type of messages you want to receive. You can specify a type among those defined in a message layout file.</pre></td> 
							</tr> 
							<tr class='list' bgcolor='#FFFFFF' bordercolor='#c6c6c6'> 
								<td>strMsgKey</td> 
								<td>String</td> 
								<td colspan='2'><pre class='list'>This is a string representing the key value of the message to be received. </pre></td> 
							</tr> 
							<tr class='list' bgcolor='#FFFFFF' bordercolor='#c6c6c6'> 
								<td>objForm</td> 
								<td>Object</td> 
								<td colspan='2'><pre class='list'>This is a From object that will receive messages.</pre></td> 
							</tr> 
							<tr class='list' bgcolor='#FFFFFF' bordercolor='#c6c6c6'> 
								<td>objDataset</td> 
								<td>Object</td> 
								<td colspan='2'><pre class='list'>This is a Dataset object to which received messages will be saved.</pre></td> 
							</tr> 
							<tr class='list' bgcolor='#FFFFFF' bordercolor='#c6c6c6'> 
								<td>strType</td> 
								<td>String</td> 
								<td colspan='2'><pre class='list'>Set the method to save the received message at the DataSet.

The “append" setting adds the received message to the last Row in the Dataset.

The “insert” setting adds the received message to the location set as the nRow parameter.
It is applied as 0 if the nRow parameter is not set.

The "replace" setting replaces the first Row with the received message.
The message is not added to the DataSet when there is no Row.

The "update" setting updates the received message to the first Row which has the same Key value among the Rows in the DataSet.
The call-back function is not called when there is no row to update.

The "allUpdate" setting updates the received message to all DataSet rows which have the same key value.

The "updateorappend" setting operates like the “update” setting but it operates as the “append” setting if there is no row which has the same key value.

* The Rows with the same key value are found in the following order.
  a) Check the name of the field where the “key” attribute value is set as “true” in the Message Layout file.
  b) Check the column that has the same name as the field checked in a).
  c) Check the row that has the same value as the Key value included in the message from the Column checked in b).</pre></td> 
							</tr> 
							<tr class='list' bgcolor='#FFFFFF' bordercolor='#c6c6c6'> 
								<td>strCallBack</td> 
								<td>String</td> 
								<td colspan='2'><pre class='list'>This is a string representing a callback performed after a received message is saved to the Dataset.

A callback is defined as a CallBackName (ChangeRow, ChangeCol, ColList, strMsgType, strActionType, strMsgID). The foregoing parameters will vary depending on the strType parameter and other conditions. Accordingly, please see the below Remark for the details.

</pre></td> 
							</tr> 
							<tr class='list' bgcolor='#FFFFFF' bordercolor='#c6c6c6'> 
								<td>nRow</td> 
								<td>Number</td> 
								<td colspan='2'><pre class='list'>This is the index number of a Dataset row to which a received message will be inserted. This parameter is application when the strType parameter is set to "insert".

The default value is 0.</pre></td> 
							</tr> 
							<tr class='list' bgcolor='#FFFFFF' bordercolor='#c6c6c6'> 
								<td>strCheck</td> 
								<td>String</td> 
								<td colspan='2'><pre class='list'>If you specify 0 as a value of this parameter, a received message will apply to the Dataset in any case.
This method searches the message layout file for messages whose check properties are set to "true". Among the found messages, this method finds the message whose field values are the same the value of this parameter.

The default value of this property is 0.</pre></td> 
							</tr> 
							<tr class='list' bgcolor='#FFFFFF' bordercolor='#c6c6c6'> 
								<td>bUseActiveFormCallBack</td> 
								<td>Boolean</td> 
								<td colspan='2'><pre class='list'>If you specify "true", the defined callback is called only from activated Forms.
If you specify "false", the defined callback is also called from deactivated Forms.

The default value is "false". </pre></td> 
							</tr> 
							<tr class='list' bgcolor='#FFFFFF' bordercolor='#c6c6c6'> 
								<td colspan='4'>Sample Call:<br><pre class='list'>this.XPush00.subscribe("CPDT", "command01", this, this.Dataset00, "append", "funcCallback"); </pre></td> 
							</tr> 
						</table> 
					</td> 
				</tr> 
				<tr> 
					<td	colspan='3' height='10'></td> 
				</tr> 
				<tr> 
					<td	width='10'></td> 
					<td	width='14'><img	src='../../subtitle_icon.gif'	width='14' height='8'	/></td> 
					<td	class='sub_title'>Return</td> 
				</tr> 
				<tr> 
					<td	colspan='3' height='10'></td> 
				</tr> 
				<tr> 
					<td	colspan='2'></td> 
					<td	class='list'> 
None 
					</td> 
				</tr> 
				<tr> 
					<td	colspan='3' height='10'></td> 
				</tr> 
				<tr> 
					<td	width='10'></td> 
					<td	width='14'><img	src='../../subtitle_icon.gif'	width='14' height='8'	/></td> 
					<td	class='sub_title'>Remark</td> 
				</tr> 
				<tr> 
					<td	colspan='3' height='10'></td> 
				</tr> 
				<tr> 
					<td	colspan='2'></td> 
					<td	class='list'><pre class='list'>- It should be connected to the X-PUSH server before executing the subscribe() method.

- The CallBack function is configured in the form of CallBackName ( ChangeRow, ChangeCol, ColList, strMsgType, strActionType, strMsgID ) and each parameter has different meaning according to the below conditions.

   a) When the strType parameter value is the “allUpdate" value and data was received.
       > ChangeRow: The index of the changed rows are set to be separated by “,”.
       > ChangeCol: Null value is set.
       > ColList: The ID of the changed row and column are set as an array.
                      In one element, the index of the changed row and the ID of the changed column are set to be specified by “,”.
       > strMsgType: “DATA” value is set.

   b) When the strType parameter value is value other than the “allUpdate" value and data was received.
       > ChangeRow: The index of the changed row is set.
       > ChangeCol: The ID of the changed column is set to be separated as “,”.
       > ColList: All column IDs are set to be separated as “,”.
       > strMsgType: “DATA” value is set.

   c) When a Recovery message was received.
       > ChangeRow: -1 value is set.
       > ChangeCol: An empty string is set.
       > ColList: An empty string is set.
       > strMsgType: "RECOVERY" value is set.
  
   d) Parameter with common value
       > strActionType: “PUSH” value is set when a general message is received.
                               “RECT” value is set when a reliability message is received.
       > strMsgID: The value to specify the message is set.
                        It is used as the parameter value in the sendResponse() method.


<b>◆ web runtime environment restrictions</b>

- The version of the X-PUSH server should be v2.6 or higher to use the XPush function in the web runtime environment.</pre></td> 
				</tr> 
				<tr> 
					<td	colspan='3' height='10'></td> 
				</tr> 
			</table> 
 
		</td> 
	</tr> 
	<tr	class='list'> 
		<td colspan='2'	valign='top'> 
			<table width='98%' border='0' align='center' cellpadding='0' cellspacing='0' style='table-layout:fixed; border-collapse:collapse; border-spacing:0; word-wrap:break-word;'>  
				<tr><td	height='1' bgcolor='#c5c5c6'></td></tr> 
			</table> 
		</td> 
	</tr> 
	<tr	class='list'> 
		<td	width='75' height='35' align='right'></td> 
		<td> 
			<table width='180' border='0'	align='right'	cellpadding='0'	cellspacing='0'> 
				<tr> 
					<td	width='15'><img	src='../../bottom_update.gif'	width='15' height='9'	/></td> 
					<td	width='185'	class='bottom_update'>LAST UPDATED Jan. 2024	</td> 
				</tr> 
			</table> 
		</td> 
	</tr> 
</table> 
</body> 
</html> 
